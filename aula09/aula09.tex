%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% talk: prototype
%%% 2002/10/16
%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%
%%% Erstellen eines Vortrags in PDF-Format wie folgt:
%%%
%%% 1) Uebersetzen der Datei mit 
%%%    pdflatex asz
%%% 2) Wenn Features von ppower4 gewuenscht werden, dann die eben
%%%    entstandene Datei asz.pdf weiterverarbeiten mit
%%%    ./ppower4 asz.pdf vortrag.pdf
%%% 3) Die Datei vortrag.pdf kann nun mit dem Acrobat Reader angesehen
%%%    werden
%%%
%%% Fuer Testzwecke ist auch ein "normales" Uebersetzen mit LaTeX
%%% moeglich:
%%% 1) latex asz
%%% 2) dvips asz.dvi -o asz.ps -t a4 -t landscape
%%% 3) Anschauen mit ghostview
%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifx\pdfoutput\undefined \documentclass[clock,landscape]{slides} \else
\documentclass[clock,landscape]{slides} \fi
%\documentclass[clock,pdftex,landscape]{slides} \fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Escrevendo em português:
\usepackage[brazil]{babel}
\usepackage[latin1]{inputenc} % isso é quase redundante
\usepackage{textcomp}
\usepackage[T1]{fontenc}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{float}
\usepackage{epstopdf}
\usepackage{psfrag}
 

\usepackage{multicol}

\usepackage{clrscode}
%----------------------------
\usepackage{tabularx}
%%% Die Datei mit dem ASZ-Layout

\usepackage{shi}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath,amssymb,amsthm} \usepackage{amsfonts}
\usepackage[colorlinks,backref]{hyperref}
%\usepackage{background}

%\usepackage{picinpar}

\hypersetup{pdftitle={Análise e projeto de algoritmos},
  pdfsubject={Análise de algoritmos}, 
  pdfauthor={Leonardo Takuno, Centro Universitário SENAC, 
  <leonardo.takuno@gmail.com>},
  pdfkeywords={acrobat, ppower4},
%  pdfpagemode={FullScreen},
  colorlinks={false},
  linkcolor={red}
}

\usepackage{color}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Pauseneffekte mit ppower4 werden moeglich

\usepackage{pause}
\newcommand\plone{\pause\pauselevel{=1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newtheoremstyle{mythm}% name
  {40pt}%      Space above
  {-15pt}%      Space below
  {\sf\itshape\blue}%      Body font
  {}%         Indent amount (empty = no indent, \parindent = para indent)
  {\sf\bfseries\green}% Thm head \vspacefont
  {.}%        Punctuation after thm head
  { }%     Space after thm head: " " = normal interword space;
        %       \newline = linebreak
  {}%         Thm head spec (can be left empty, meaning `normal')

\theoremstyle{mythm}
\newtheorem{theorem}             {Theorem}       
\newtheorem{claim}     [theorem] {Claim}         
\newtheorem{lemma}     [theorem] {Lemma}         
\newtheorem{corollary} [theorem] {Corollary}     
\newtheorem{fact}      [theorem] {Fact}          
\newtheorem{conjecture}[theorem] {Conjecture}    

\newtheorem{problem}   [theorem] {Problema}       
\newtheorem{propriedade}  [theorem] {Propriedade}       
\newtheorem{corolario}  [theorem] {Corolário}       
\newtheorem{definition}   [theorem] {Definição}       

%%% Symbole

\newcommand{\NN}{\mathbb{N}} \newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}} \newcommand{\1}{{{\mathchoice {\rm
        1\mskip-4mu l} {\rm 1\mskip-4mu l} {\rm 1\mskip-4.5mu l} {\rm
        1\mskip-5mu l}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\let\phi\varphi
\let\epsilon\varepsilon
\let\rho\varrho
\let\tilde\widetilde
\let\approx\thickapprox
\let\sim\thicksim

\def\({\left(}
\def\){\right)}
\def\[{\left[}
\def\]{\right]}
\def\<{\langle}
\def\>{\rangle}
\let\:\colon
\def\llfloor{\left\lfloor}
\def\rrfloor{\right\rfloor}
\def\llceil{\left\lceil}
\def\rrceil{\right\rceil}

%%% Textmakros
\def\ex{\mathop{\text{\rm ex}}\nolimits} 
\def\cB{{\mathcal B}} 
\def\cG{{\mathcal G}}
\def\cS{{\mathcal S}} 
\def\cW{{\mathcal W}} 
\def\cQ{{\mathcal Q}} 
\def\PP{{\mathbb P}}
\def\EE{{\mathbb E}} 
\def\GG{{\mathbb G}} 
\def\e{{\rm e}}
\def\epsilon{{\varepsilon}} 
\def\DISC{\mathop{\textrm{\rm DISC}}\nolimits} 
\def\EIG{\mathop{\textrm{\rm EIG}}\nolimits}
\def\CIRCUIT{\mathop{\textrm{\rm CIRCUIT}}\nolimits}
\def\CYCLE{\mathop{\textrm{\rm CYCLE}}\nolimits}
\def\SUB{\mathop{\textrm{\rm SUB}}\nolimits}
\def\NSUB{\mathop{\textrm{\rm NSUB}}\nolimits}
\def\PAIR{\mathop{\textrm{\rm PAIR}}\nolimits}
\def\TFNSUB{\mathop{\textrm{\rm TFNSUB}}\nolimits}
\def\BDD{\mathop{\textrm{\rm BDD}}\nolimits}
\def\eps{\varepsilon}

\def\rmd{\text{\rm d}}
\def\wtc{\widetilde{c}\,}
\def\whc{\widehat{c}}
\def\bfb{{\bf b}}
\def\bff{{\bf f}}
\def\bft{{\bf t}}
\def\bfx{{\bf x}}
\def\bfz{{\bf z}}
\def\cB{{\mathcal B}}
\def\cD{{\mathcal D}}
\def\cG{{\mathcal G}}
\def\cM{{\mathcal M}}
\def\cN{{\mathcal N}}
\def\cR{{\mathcal R}}
\def\cS{{\mathcal S}}
\def\cW{{\mathcal W}}
\def\PP{{\mathbb P}}
\def\EE{{\mathbb E}}
\def\FF{{\mathbb F}}
\def\NN{{\mathbb N}}
\def\RR{{\mathbb R}}
\def\ZZ{{\mathbb Z}}
\def\e{{\rm e}}
\def\card{\mathop{\text{\rm card}}\nolimits}
\def\rank{\mathop{\text{\rm rank}}\nolimits}
\def\trace{\mathop{\text{\rm trace}}\nolimits}
\def\Ave{\mathop{\text{\rm Ave}}\nolimits}
\def\Bi{\mathop{\text{\rm Bi}}\nolimits}
\def\im{\mathop{\text{\rm im}}\nolimits}
\def\ind{\mathop{\text{\rm ind}}\nolimits}
\def\dist{\mathop{\text{\rm dist}}\nolimits}
\def\nDist{\mathop{\text{\rm \#Dist}}\nolimits}
\let\Dist\nDist
\def\De{D_{\rm e}}
\def\sumL{\sum\nolimits_1}
\def\sumS{\sum\nolimits_2}
\def\GF{\mathop{\text{\rm GF}}\nolimits}
\let\FF\GF
\def\Bip{\mathop{\text{\rm Bip}}\nolimits}
\def\adj{\mathop{\text{\rm adj}}\nolimits}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\nx}{{\hfill\vspace*{-2cm}\tiny +}}

%\newcommand{\red}[1]{\textcolor{red}{#1}}
%\newcommand{\blue}[1]{\textcolor{blue}{#1}}
%\newcommand{\yellow}[1]{\textcolor{yellow}{#1}}
%\newcommand{\green}[1]{\textcolor{green}{#1}}
%\newcommand{\darkgreen}[1]{\textcolor{darkgreen}{#1}}
\def\red{\color[rgb]{0.7,0,0}}
\def\green{\color[rgb]{0,.8,0}}
\def\darkgreen{\color[rgb]{0.1,0.4,0.0}}
\let\dgreen\darkgreen
\def\blue{\color[rgb]{0,0,.8}}
\def\yellow{\color[rgb]{1,1,0}}
\def\black{\color[rgb]{0,0,0}}

\def\pink{\color[rgb]{1,0,1}}
\def\brown{\color[rgb]{.5,.1,.3}}
\def\lilaz{\color[rgb]{.5,0,.5}}
\def\hmmm{\color[rgb]{.3,.1,.5}}
\def\magenta{\color[rgb]{.6,.05,.05}}

\newcommand{\uc}[1]{\centerline{\underline{#1}}}
\newcommand{\pic}[1]{\fbox{picture:{#1}}}
%\renewcommand{\bf}{\mbox{}}
\newcommand{\cP}{{\cal P}} \newcommand{\cT}{{\cal T}}
\newcommand{\add}{\mbox{\rm add}} \newcommand{\pr}{\mbox{\rm Pr}}

\def\stitle#1{\slidetitle{\red #1}\vspace{-0pt}}

\def\itemtrig{$\vartriangleright$}
\def\itemcirc{$\circ$}
\def\itemT{\item[\itemtrig]}
\def\itemC{\item[$\circ$]}

\everymath={\blue}
\everydisplay={\blue}

\renewcommand{\For}{\textbf{\blue para} }
\renewcommand{\To}{\textbf{\blue até} }
\renewcommand{\Do}{\>\>\textbf{\blue faça}\hspace*{-0.7em}\'\addtocounter{indent}{1}}
\renewcommand{\While}{\textbf{\blue enquanto} }
\renewcommand{\If}{\textbf{\blue se} }
\renewcommand{\Then}{\>\textbf{\blue então}\>\hspace*{0.5em}\addtocounter{indent}{1}}
\renewcommand{\Else}{\kill\addtocounter{indent}{-1}\liprint\>\textbf{\blue senão}\>\hspace*{0.5em}\addtocounter{indent}{1}}
\renewcommand{\ElseIf}{\kill\addtocounter{indent}{-1}\liprint\textbf{\blue senão se} }
\renewcommand{\ElseNoIf}{\kill\addtocounter{indent}{-1}\liprint\textbf{\blue senão} \addtocounter{indent}{1}}
\renewcommand{\Return}{\textbf{\blue retorne} }


\newcommand{\TITLE}[1]{\item[#1]}

% ugly hack for for/while
\newbox\fixbox

% end of hack
\newcommand{\algcost}[2]{\strut\hfill\makebox[3.5cm][l]{#1}\makebox[4cm][l]{#2}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%%Anuschs Extras
%
%\def\enddiscard{}
%\long\def\discard#1\enddiscard{}
%
%%%\vpagecolor{bgblue}
%\hypersetup{pdfpagetransition=Dissolve}
%\hypersetup{pdfpagetransition=R}
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Farben kann man hier definieren

\definecolor{bgblue}{rgb}{0.04,0.39,0.53}

\definecolor{darkyellow}{rgb}{0.94,0.820,0.058}
\definecolor{orange}{rgb}{0.95,0.47,0.14}
\definecolor{darkgreen}{rgb}{0.0,0.5,0.0}

\definecolor{blue2}{rgb}{0.1,0.39,0.53}
\definecolor{yellow1}{rgb}{1,1,0} \definecolor{pink}{rgb}{1,0,1}

\definecolor{lightred}{rgb}{1,0.5,0.5}
\definecolor{lightred2}{rgb}{1,0.7,0.7}
\definecolor{lightred3}{rgb}{1,0.3,0.3}
\definecolor{black}{rgb}{0,0,0} \definecolor{gray1}{rgb}{0.9,0.9,0.9}
\definecolor{red1}{rgb}{1,1,0.9}

\title{Análise e projeto de algoritmos} 
\author{{\blue L.~Takuno} (SENAC)}
\date{{\dgreen 1o. Semestre 2019}} 

%%% Hier beginnt die Praesentation

\begin{document}\def\proofname{{\bf\green Prova.}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Deckblatt
%%%%%%%%%%%%%%%%%%%\usepackage{clrscode3e}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\maketitle

%\slidesubhead{}  %% Teilvortrags-Titel (hier noch nicht)
                 %% Dieser erscheint spaeter oben links unter
                 %% dem ASZ Gesamt-Titel

%%%%%%%%%%%%%%%%%%%%%%% TOC %%%%%%%%%%%%%%%%%%

%\slidesubhead{Outline!!!}

\begin{slide}
  \stitle{Fontes principais}
  \begin{enumerate}\makeatletter\itemsep\z@\makeatother
  \item Cormem T. H.; Leiserson C. E.; Rivest R.: Stein C.. \textit{Introduction to Algorithms}, $3^a$ edição, MIT Press, 2009
  \item Análise de algoritmo - IME/USP (prof. Paulo Feofiloff)
    \verb|http://www.ime.usp.br/~pf/analise_de_algoritmos| 
	
  \end{enumerate}
  \end{slide}
 
 
\begin{slide}
  \stitle{Programação dinâmica}  
\end{slide}

\begin{slide}
  \stitle{Programação dinâmica}  

Quando se aplica:

\itemtrig\ Problemas de otimização

\itemtrig\ Solução consiste em uma sequência de decisões
\end{slide}

\begin{slide}
  \stitle{Programação dinâmica}  
Características:
  
\itemtrig\ \textbf{Existência de subestrutura ótima}: as soluções ótimas do problema contém soluções ótimas dos subproblemas

\itemtrig\ \textbf{Fórmula de recorrência}: descreve a relação entre as soluções ótimas dos subproblemas.

\itemtrig\ \textbf{Sobreposição de subproblemas}: a solução ótima de um subproblema é usada várias vezes mas \textbf{calculada uma vez}!

\end{slide}


\begin{slide}
  \stitle{Programação dinâmica}  
Características:
  
\itemtrig\ \textbf{Soluções de subproblemas são armazenadas em tabelas}, logo é preciso que um número total de subproblemas que precisam ser resolvidos seja pequeno (polinomial no tamanho da entrada)

\itemtrig\ \textbf{Estratégia bottom-up} (diferente de divisão e conquista que é top down) e possui muitas sequências de decisões.

\itemtrig\ "Não existe" prova de corretude

\end{slide}


\begin{slide}
  \stitle{Cálculo fatorial}  
\end{slide}


\begin{slide}
  \stitle{Cálculo fatorial}  
solução recursiva  natural
  
\begin{codebox}
\Procname{$\proc{fatorial}(n)$}
\li  \If $n=0$   
\li  \Then  \Return $1$
\li  \Else  
\li  \Return $n * \proc{fatorial}(n-1)$ 
\End
\End
\end{codebox}  

Como é uma solução com programação dinâmica?
  
\end{slide}

\begin{slide}
  \stitle{Cálculo fatorial (PD)}  
  \begin{codebox}
\Procname{$\proc{fatorial}(n)$}
\li  \If $n=0$   
\li  \Then  \Return $1$
\li  \Else  
\li   \If ($fat[n] != 0$)  \itemtrig\ caso já calculado
\li   \Then  \Return $fat[n]$
\li  \Else  
\li  \Return $fat[n] = n * \proc{fatorial}(n-1)$ 
\End
\End
\End
\end{codebox}  
\end{slide}

 
\begin{slide}
  \stitle{Multiplicação de matrizes}  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  
  
\textbf{Problema:}
Multiplicar n matrizes realizando o número mínimo de operações.

$$M = M_1 \times M_2 \times \dots M_n$$

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

Exemplo: $(A_1)_{10 \times 100}$, $(A_2)_{100 \times 5}$ e $(A_3)_{5 \times 50}$

Quantas multiplicações são realizadas nas sequencias abaixo?

$$\begin{array}{ll}
A & = (A_1 \times A_2) \times A_3\\
A &= A_1 \times (A_2 \times A_3)
\end{array} $$

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

Exemplo: $(A_1)_{10 \times 100}$, $(A_2)_{100 \times 5}$ e $(A_3)_{5 \times 50}$

Número de multiplicações:

$$\begin{array}{ll}
A & = (A_1 \times A_2) \times A_3\\
  & = (10 \times 100 \times 5) + (10 \times 5 \times 50)\\
  & = 7500 \textrm{ operações}
\end{array} $$

$$\begin{array}{ll}
A & = A_1 \times (A_2 \times A_3)\\
  & = (100 \times 5 \times 50) + (10 \times 100 \times 50)\\
  & = 75000 \textrm{ operações}
\end{array} $$
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

Exemplo: $(A_1)_{10 \times 100}$, $(A_2)_{100 \times 5}$ e $(A_3)_{5 \times 50}$

Número de multiplicações:

$$\begin{array}{ll}
A & = (A_1 \times A_2) \times A_3\\
  & = 7500 \textrm{ operações}
\end{array} $$

$$\begin{array}{ll}
A & = A_1 \times (A_2 \times A_3)\\
  & = 75000 \textrm{ operações}
\end{array} $$

Conclusão: A ordem das multiplicações faz \textbf{\blue muita} diferença
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  
Como determinar a sequência ótima de multiplicação?
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  
Como determinar a sequência ótima de multiplicação?

\itemtrig\ Algoritmo força bruta é "impraticável": existem $\Omega(2^n)$ possibilidades (número de Catalão) 


Aplicando programação dinâmica:

\itemtrig\ É possível determinar uma sequência ótima eficiente (polinomial)

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  
  
  Para resolver este problema, tudo que precisamos é saber qual o melhor índice $k$ tal que 
  
$$A = (A_1 \times A_2 \times \cdots A_k) \cdot (A_{k+1} \times A_{k+2} \times \cdots A_{n})$$  

onde $k$ varia de $1$ a $n-1$.
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  
Denotemos por $m[i,j]$ o número mínimo de multiplicações necessárias para multiplicar $A_i \cdots A_j$, $i \leq j$.  Temos que:

        $m[i,j] = \left\{  \begin{array}{ll} 
                0 & \textrm{, se } i=j \\
                min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\} & \textrm{, se } i<j
                \end{array} \right. $


onde $p_0, p_1, \cdots p_n$ determinam as dimensões das matrizes: cada $A_i$ tem dimensão $p_{i-1} \times p_i$.
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  
\begin{center}
\includegraphics[width=.6\textwidth]{fig01}
\end{center}

O algoritmo recursivo para calcular $m[i,j]$ por esta fórmula seria excessivamente lenta (exponencial)

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes} 
Com a programação dinâmica é possível construir uma tabela para armazenar os valores de $m[i,j]$ de forma \textit{bottom-up}, usando memoização.

\begin{enumerate}
\item $m[i,i] = 0$, para $1 \leq i \leq n$.
\vspace{-1cm}\item $m[i,i+1]$ são calculados, para $1 \leq i \leq n-1$.
\vspace{-1cm}\item $m[i,i+2]$ são calculados, para $1 \leq i \leq n-2$.
\vspace{-1cm}\item e assim por diante
\end{enumerate}

\end{slide}
\begin{slide}
  \stitle{Multiplicação de matrizes} 
Exemplo: $A = A_1 \times A_2 \times A_3 \times A_4$ com $p = \{200,2,30,20,5\}$

$\begin{array}{ll}
A & = A_1 \hspace{1cm} \times A_2 \hspace{1cm} \times A_3 \hspace{1.5cm} \times A_4 \\
\end{array} $  
  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes} 
Exemplo: $A = A_1 \times A_2 \times A_3 \times A_4$ com $p = \{200,2,30,20,5\}$

$\begin{array}{ll}
A & = A_1 \hspace{1cm} \times A_2 \hspace{1cm} \times A_3 \hspace{1.5cm} \times A_4 \\
  & (200 \times 2) (2 \times 30) (30 \times 20) (20 \times 5)\\
\end{array} $  
  
\end{slide}


\begin{slide}
  \stitle{Multiplicação de matrizes} 
Exemplo: $A = A_1 \times A_2 \times A_3 \times A_4$ com $p = \{200,2,30,20,5\}$

$\begin{array}{ll}
A & = A_1 \hspace{1cm} \times A_2 \hspace{1cm} \times A_3 \hspace{1.5cm} \times A_4 \\
  & (200 \times 2) (2 \times 30) (30 \times 20) (20 \times 5)\\
  & \;(p_0 \times p_1) (p_1 \times p_2) (p_2 \times p_3) (p_3 \times p_4)\\
\end{array} $  
  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes} 
Exemplo: $A = A_1 \times A_2 \times A_3 \times A_4$ com $p = \{200,2,30,20,5\}$

$\begin{array}{ll}
A & = A_1 \hspace{1cm} \times A_2 \hspace{1cm} \times A_3 \hspace{1.5cm} \times A_4 \\
  & (200 \times 2) (2 \times 30) (30 \times 20) (20 \times 5)\\
  & \;(p_0 \times p_1) (p_1 \times p_2) (p_2 \times p_3) (p_3 \times p_4)\\
\end{array} $  

$m[1,1] = m[2,2] = m[3,3] = m[4,4] = 0$
  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes} 
Exemplo: $A = A_1 \times A_2 \times A_3 \times A_4$ com $p = \{200,2,30,20,5\}$

$\begin{array}{ll}
A & = A_1 \hspace{1cm} \times A_2 \hspace{1cm} \times A_3 \hspace{1.5cm} \times A_4 \\
  & (200 \times 2) (2 \times 30) (30 \times 20) (20 \times 5)\\
  & \;(p_0 \times p_1) (p_1 \times p_2) (p_2 \times p_3) (p_3 \times p_4)\\
\end{array} $  

$m[1,1] = m[2,2] = m[3,3] = m[4,4] = 0$

$m[1,2] = 12000, \hspace{1cm} m[2,3] = 1200,\hspace{1cm}  m[3,4] = 3000$

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\} \textrm{, para } i \cdots j-1$
  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,3] = min\{ m[1,k]  + m[k+1, 3] + p_{0} p_{k} p_{3} \}, k = 1, 2$   
\end{slide}
 

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,3] = min\{ m[1,k]  + m[k+1, 3] + p_{0} p_{k} p_{3} \}, k = 1, 2$   


$\begin{array}{ll}
m[1,3] &= min\{m[1,1]  + m[2, 3] + p_{0} p_{1} p_{3}, 
m[1,2]  + m[3, 3] + p_{0} p_{2} p_{3}\} \\
\end{array}
$   

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,3] = min\{ m[1,k]  + m[k+1, 3] + p_{0} p_{k} p_{3} \}, k = 1, 2$   


$\begin{array}{ll}
m[1,3] &= min\{m[1,1]  + m[2, 3] + p_{0} p_{1} p_{3}, 
m[1,2]  + m[3, 3] + p_{0} p_{2} p_{3}\} \\
       &= min\{0  + 1200 + 8000, 
12000  + 0 + 120000\} \\
\end{array}
$   

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,3] = min\{ m[1,k]  + m[k+1, 3] + p_{0} p_{k} p_{3} \}, k = 1, 2$   


$\begin{array}{ll}
m[1,3] &= min\{m[1,1]  + m[2, 3] + p_{0} p_{1} p_{3}, 
m[1,2]  + m[3, 3] + p_{0} p_{2} p_{3}\} \\
       &= min\{0  + 1200 + 8000, 
12000  + 0 + 120000\} \\
	   &= 9200 \hspace{1cm}(A_1 \times (A_2 \times A_3))
\end{array}
$   

\end{slide}
 
\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\} \textrm{, para } i \cdots j-1$
  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[2,4] = min\{ m[2,k]  + m[k+1, 4] + p_{1} p_{k} p_{4} \}, k = 2, 3$   
\end{slide}
 
\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[2,4] = min\{ m[2,k]  + m[k+1, 4] + p_{1} p_{k} p_{4} \}, k = 2, 3$   

$\begin{array}{ll}
m[2,4] &= min\{m[2,2]  + m[3, 4] + p_{1} p_{2} p_{4}, 
m[2,3]  + m[4, 4] + p_{1} p_{3} p_{4}\} \\
       &= min\{0  + 3000 + 300, 
1200  + 0 + 200\} \\
	   &= 1400 \hspace{1cm}((A_2 \times A_3) \times A_4)
\end{array}
$   
\end{slide} 

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\} \textrm{, para } i \cdots j-1$
  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,4] = min\{ m[1,k]  + m[k+1, 4] + p_{0} p_{k} p_{4} \}, k = 1,	2, 3$   
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,4] = min\{ m[1,k]  + m[k+1, 4] + p_{0} p_{k} p_{4} \}, k = 1,	2, 3$   

$\begin{array}{ll}
m[1,4] &= min\{m[1,1]  + m[2, 4] + p_{0} p_{1} p_{4}, \\
       & \hspace{2.6cm} m[1,2]  + m[3, 4] + p_{0} p_{2} p_{4}, \\
       & \hspace{2.6cm} m[1,3] + m[4, 4] + p_{0} p_{3} p_{4} \} \\
       &= min\{0  + 1400 + 2000, \\
       & \hspace{2.6cm} 12000 + 3000 + 30000,\\
       & \hspace{2.6cm} 9200 + 0 + 20000\} \\
	   &= 3400 \hspace{1cm}(A_1 \times ((A_2 \times A_3) \times A_4))
\end{array}
$   

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

$m[i,j] = min\{ m[i,k] + m[k+1, j] + p_{i-1}p_kp_j\},  k = i \cdots j-1$
  
  
$m[1,4] = min\{ m[1,k]  + m[k+1, 4] + p_{0} p_{k} p_{4} \}, k = 1,	2, 3$   

$\begin{array}{ll}
m[1,4] &= min\{m[1,1]  + m[2, 4] + p_{0} p_{1} p_{4}, \\
       & \hspace{2.6cm} m[1,2]  + m[3, 4] + p_{0} p_{2} p_{4}, \\
       & \hspace{2.6cm} m[1,3] + m[4, 4] + p_{0} p_{3} p_{4} \} \\
       &= min\{0  + 1400 + 2000, \\
       & \hspace{2.6cm} 12000 + 3000 + 30000,\\
       & \hspace{2.6cm} 9200 + 0 + 20000\} \\
	   &= 3400 \hspace{1cm}(A_1 \times ((A_2 \times A_3) \times A_4))
\end{array}
$   

Solução ótima: $(A_1 \times ((A_2 \times A_3) \times A_4))$

\end{slide}

\begin{slide}
  \stitle{Exercícios}  
  
1) Aplique o algoritmo para multiplicar 5 matrizes, onde 
$p = \{30,35,15,5,10,20\}$  

2) Apresente uma solução para a variante do problema de multiplicação de matrizes em que o objetivo é maximizar o número de operações.
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

\begin{center}
\includegraphics[width=.5\textwidth]{fig02}
\end{center}

$$\displaystyle \sum^{n-1}_{i=1} i \cdot (n-i) = O(n^3)$$
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

\textbf{algoritmo:} $\proc{ordem-cadeia-matriz}()$

\textbf{entrada:} um vetor $p[0 .. n]$ das dimensões das matrizes, e $n$ o número de matrizes

\textbf{saída:} $m[1,n]$ (solução ótima)
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

\begin{codebox}
\Procname{$\proc{ordem-cadeia-matriz}(p,n)$}
\li  \For $i = 1$ \To $n$ \textbf{\blue faça} $m[i,i] = 0$
\End
\li  \For $l = 2$ \To $n$ \textbf{\blue faça} 
\li  \> \> \For $i = 1$ \To $n-l+1$ \textbf{\blue faça} 
\li  \> \> \>  $j = i + l - 1$
\li  \> \> \>  $m[i,j] = \infty$
\li  \> \> \> \For $k = i$ \To $j-1$ \textbf{\blue faça} 
\li  \> \> \> \> $q = m[i,k] + m[k+1, j]+p[i-1]p[k]p[j]$
\li  \> \> \> \> \If $q < m[i,j]$ \textbf{\blue então}
\li  \> \> \> \> \> $m[i,j] = q$
\li  \> \> \> \> \> $s[i,j] = k$ \itemtrig\ usado para recuperar a
\li  \> \> \> \> \> \> \> \>\itemtrig\  parentização ótima
\End
\End
\End
\End
\end{codebox}  

\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

\begin{codebox}
\Procname{$\proc{imprime-parenteses-otimo}(A, s, i, j)$}
\li  \If $i = j$ 
\li \Then $\proc{imprime } A_i$	
\li \Else
\li  $\proc{imprime } "("$	
\li  $\proc{imprime-parenteses-otimo}(A, s, i, s[i,j])$
\li  $\proc{imprime-parenteses-otimo}(A, s, s[i,j]+1, j)$
\li  $\proc{imprime } ")"$	
\End
\End
\end{codebox}  
\end{slide}

\begin{slide}
  \stitle{Multiplicação de matrizes}  

\begin{codebox}
\Procname{$\proc{calcula-produto}(A, s, i, j)$}
\li  \If $i = j$ 
\li \Then \Return $A_i$	
\li \Else
\li  $X = \proc{calcula-produto}(A, s, i, s[i,j])$
\li  $Y = \proc{calcula-produto}(A, s, s[i,j]+1, j)$
\li  \Return $\proc{multiplica(X,Y)}$
\End
\End
\end{codebox}  
\end{slide}

\begin{slide}
  \stitle{Subsequência Comum Máxima (SCM)}  
\end{slide}

\begin{slide}
  \stitle{Subsequência Comum Máxima (SCM)}  
  Problema: Dadas duas sequências X e Y determinar a maior subsequência comum de X e Y.
  
Exemplo: X = ATCTGAT e Y = TGCATTA  
\end{slide}

\begin{slide}
  \stitle{Subsequência Comum Máxima (SCM)}  
  Problema: Dadas duas sequências X e Y determinar a maior subsequência comum de X e Y.
  
Exemplo: X = ATCTGAT e Y = TGCATTA  

SCM(X,Y) = TCTA
\end{slide} 

\begin{slide}
  \stitle{Subsequência Comum Máxima (SCM)}  
  Problema: Dadas duas sequências X e Y determinar a maior subsequência comum de X e Y.
  
Exemplo: X = ATCTGAT e Y = TGCATTA  

SCM(X,Y) = TCTA

Visualmente temos:

\begin{verbatim}
                AT_C_TGAT
                 | | | | 
                _TGCAT_A_
\end{verbatim}

\end{slide} 

\begin{slide}
  \stitle{Subsequência Comum Máxima (SCM)} 
Seja $c[i,j]$ o comprimento da sequencia comum máxima dos prefixos $X_i$ e $Y_j$. Se $|X|=m$ e $|Y|=n$, então $c[m,n]$ é o valor \textbf{ótimo}.
\end{slide} 

\begin{slide}
  \stitle{Subestrutura ótima} 
  Seja $Z = z_1 \cdots z_k$ a subsequência comum máxima de $X = x_1 \cdots x_m$ e $Y = y_1 \cdots y_n$, temos:
  
  \hspace{1cm}\itemtrig\ Se $x_m=y_n$, então $z_k=x_m=y_n$ e $Z_{k-1} = SCM(X_{m-1}, Y_{n-1})$
  
  \vspace{-1cm}\hspace{1cm}\itemtrig\ Se $x_m \neq y_n$, então $z_k \neq x_m$ e $Z = SCM(X_{m-1}, Y)$

    \vspace{-1cm}\hspace{1cm}\itemtrig\ Se $x_m \neq y_n$, então $z_k \neq y_n$ e $Z = SCM(X, Y_{n-1})$
  
Fórmula de recorrência:

  $c[i,j]= \left\{  \begin{array}{ll} 
                0 & \textrm{, se } i=0 \textrm{ ou } j=0 \\
                c[i-1,j-1] + 1 & \textrm{, se } i,j>0 \textrm{ e } x_i = y_j\\
                max \{c[i-1,j], c[i,j-1]\} & \textrm{, se } i,j>0 \textrm{ e } x_i \neq y_j                
                \end{array} \right. $  
\end{slide} 

\begin{slide}
\begin{codebox}
\Procname{$\proc{SCM}(X,Y, m, n, c, b)$}
\li \For $i = 0$ \To $m$ {\blue \textbf{faça}} $c[i,0] = 0$
\li \For $j = 0$ \To $n$ {\blue \textbf{faça}} $c[0,j] = 0$
\li \For $i = 1$ \To $m$ {\blue \textbf{faça}} 
\li \> \For $j = 0$ \To $n$ {\blue \textbf{faça}} 
\li \> \> \If $x_i == y_i$ {\blue \textbf{então}}
\li \> \> \> $c[i,j] = c[i-1,j-1]+1$
\li \> \> \> $b[i,j] = "\nwarrow" $
\li \> \> {\blue \textbf{senão}}
\li \> \> \> \If $c[i, j-1] > c[i-1, j]$ {\blue \textbf{então}}
\li \> \> \> \> $c[i,j] = c[i,j-1]$
\li \> \> \> \> $b[i,j] = "\leftarrow"$
\li \> \> \> {\blue \textbf{senão}}
\li \> \> \> \> $c[i,j] = c[i-1,j]$
\li \> \> \> \> $b[i,j] = "\uparrow"$
\li  \Return $(c[m,n], b)$
\End
\End
\end{codebox}   
\end{slide} 


\begin{slide}
  \stitle{Obrigado}
\end{slide}

\end{document}

% Local Variables: 
% mode: latex
% eval: (Portug-mode)
% TeX-master: t
% End: 
